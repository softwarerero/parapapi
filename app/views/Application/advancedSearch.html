#{extends 'main.html' /}
#{set title: 'Search' /}
#{set 'moreStyles'}
    <link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/smoothness/jquery-ui-1.8.6.custom.css'}">
#{/set}
#{set 'moreScripts'}
    <script src="@{'/public/javascripts/jquery-ui-1.8.6.custom.min.js'}" type="text/javascript" ></script>
#{/set}

        
#{form @Application.advancedSearch(adSearch), enctype:'multipart/form-data'}
    <div style="width: 100%;" class="form">

    <noscript>
        <p class="error">
        Javascript must be enabled to properly navigate this site.
        </p>
    </noscript>
    #{ifErrors}
        <p class="error">
            ${errors[0]}
        </p>
    #{/ifErrors}

    %{
        def currentType = _('controllers.CRUD$ObjectType').forClass(object.getClass().getName())
    }%

    <p></p>
        <div style="width: 48%; float: left;">
            #{form/renderText object: object, attr: "text"/}
            #{form/renderSelect4Enum name: "language", value: object.language, items: models.Ad.Language /}
            #{form/renderText object: object, attr: "postedAt", size: 10/}
            #{form/renderSelect4Enum name: "handOver", value: object.handOver, items: models.Ad.HandOver /}
            #{form/renderText object: object, attr: "priceFrom", size: 15/}
            #{form/renderSelect4Model name: "mainCategory", value: object.mainCategory, items: mainCategories /}
            #{form/renderSelect4Model name: "subCategory", value: object.subCategory, items: subCategories /}
        </div>
        <div style="width: 4%; float: left;">&nbsp;</div>
        <div style="width: 48%; float: left;">
            #{form/renderSelect4Enum name: "offer", value: object.offer, items: models.Ad.OfferType /}
            #{form/renderSelect4Enum name: "priceType", value: object.priceType, items: models.Ad.PriceType /}
            #{form/renderSelect4Enum name: "currency", value: object.currency, items: models.Ad.Currency /}
            #{form/renderText object: object, attr: "priceTo", size: 15/}
            #{form/renderSelect4Enum name: "department", value: object.department, items: models.Ad.Department.values() /}
            #{form/renderText object: object, attr: "city"/}
            #{form/renderText object: object, attr: "zone"/}
        </div>
    </div>
    <div style="clear: both; text-align: left;">
        <br/>
        <input type="submit" value="&{'Search'}" />
    </div>
#{/form}


<script type="text/javascript">

    $('#object_postedAt').datepicker({ dateFormat: 'yy-mm-dd'});

    var getSubCategories = #{jsAction @MainCategories.getSubCategories(':id') /}

    $('#object_mainCategory').change(function() {
        $('#object_subCategory').load(getSubCategories({id: $(this).val()}));
    });

    var cities = ${models.City.toJSON().raw()};
    $(function() {
		$("#object_city").autocomplete({
			source: cities
		});
	});

    // wait for the DOM to be loaded
    $(document).ready(function() {
    });
</script>
