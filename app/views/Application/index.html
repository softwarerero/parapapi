#{extends 'main.html' /}
#{set title: messages.get('main.title') /}

#{ifErrors}
    <p class="error">
        ${errors[0]}
    </p>
#{/ifErrors}


<form action="@{Application.search()}" method="GET" id="form1">
    <input type="text" name="searchString" size="50" value="${searchString}"/> 
    <input type="submit" class="btn primary" value="&{'ParaPapi'}" />
        <input id="advancedSearch" class="btn" type="button" onclick="location.href='@{SecuredApp.advancedSearch()}'" value="&{'AdvancedSearch'}" />
        <input style="float: right;" id="createAd" class="btn" type="button" onclick="location.href='@{SecuredApp.createAd()}'" value="&{'CreateAd'}" />
    #{if controllers.auth.Security.isConnected()}
    #{/if}
</form>

<div id="categories" class="categories">
</div>


<script type="text/javascript">

    var renderMaincategoryList = #{jsAction @Application.renderMaincategoryList(':cat, :german, :english, :spanish') /}

    var mainCategoryChoosen = function(cat) {
        $.get('@{Application.renderMaincategoryList()}', {category: cat}, function(data) {
            document.write(data);
            document.close();
        });
    };

    var subCategoryChoosen = function(cat) {
        $.get('@{Application.renderSubcategoryList()}', {category: cat}, function(data) {
            document.write(data);
            document.close();
        });
    };

    var renderCategoryList = #{jsAction @Application.renderCategories() /}
    function langSelect() {
        $("#categories").load(renderCategoryList());
    };

    function Refresh() { // reload the page
        location.reload();
    };
    
    $(document).ready(function() {
        langSelect();
//        setTimeout("Refresh()", 60000); //60 sec.
    });

</script>
